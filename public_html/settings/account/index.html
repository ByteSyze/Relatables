<!DOCTYPE html>
<!-- Copyright (C) Tyler Hackett 2014-->
<?php
	require $_SERVER['DOCUMENT_ROOT'] . '/global.php';

	if($_SESSION['id'] == null)
	{
		header('Location: /');
		exit;
	}
?>
<html>
	<head>
		<title>Account Settings</title>

		<?php
			GlobalUtils::getMeta();
			GlobalUtils::getCSS('settings/theme');
		?>

		<link rel="canonical" href="/">
	</head>
	<body>
		<div class="content-wrapper">
			<?php require($_SERVER["DOCUMENT_ROOT"] . '/navigation.php'); ?>
			<div class="content">
				<div class="page-jumbo">
				  <div class="grid wrap">
					<div class="unit whole">
					  <h1 class="page-title">Account Settings</h1>
					</div>
				  </div>
				</div>
				<div class="grid wrap wider">
					<?php include "../settingsnav.php" ?>
					<div class="unit three-fourths">
						<div class="box">
							<div class="box-content">
								<form id='settings-form' method='POST' action='/update.php' class="vertical">
									<input type='hidden' name='t' value='account' />
									<label for="">Username</label>
									<div>
										<input type="text" id='user_input' name='username' onkeydown='checkLimit(event,this,32,false);' onkeyup='verifyUser();checkHideErrors(this, user_verify_img);' placeholder='<?php echo GlobalUtils::$user->getUsername(); ?>' />
										<div class='verify xmark' data-err-popup ></div><div class='popup-offset'><div class='error-popup' id='user-popup'></div></div>
									</div>
									<div>
										<div>
											<label for="currentpass_input">Current Password</label>
											<div>
												<input type="password" id='currentpass_input' type='password' name='oldpassword' autocomplete='off' />
												<div class='verify xmark' data-err-popup ></div><div class='popup-offset'><div class='error-popup' id='currentpass-popup'></div></div>
											</div>
											</div>
										<div>
											<label for="pass_input">New Password</label>
											<div>
												<input id='pass_input' type="password" name='newpassword' onkeyup='verifyPassword();checkHideErrors(this, pass_verify_img);' autocomplete='off' />
												<div class='verify xmark' data-err-popup ></div><div class='popup-offset'><div class='error-popup' id='new-password-popup'></div></div>
											</div>
											<label for="repass_input">Retype New Password</label>
											<div>
												<input id='repass_input' type='password' name='renewpassword' onkeyup='verifyRePassword()'  autocomplete='off' />
												<div class='verify xmark' data-err-popup ></div><div class='popup-offset'><div class='error-popup' id='renew-password-popup'></div></div>
											</div>
										</div>
									</div>

									<label for="">Email <div class='popup-offset'><div class='error-popup' id='email-popup'></div></div></label>
									<div>
										<input id='email_input' name='email' onkeydown='checkLimit(event,this,32,false);' onkeyup='verifyEmail();checkHideErrors(this, email_verify_img);' placeholder='<?php echo GlobalUtils::$user->getEmail(); ?>'></input>
										<div class='verify xmark' data-err-popup ></div><div class='popup-offset'><div class='error-popup' id='email-popup'></div></div>
									</div>
								</form><br>
								<div class="buttons">
									<a class="button red-hover" id='delete-button' data-togg='#delete-account-popup'>Delete Account</a>
									<input class="button blue-hover" id='save-button' type='submit' value='Save Changes' />
								</div>
								
								<div id='delete-account-popup' class='popup'>
									<h2>Delete account?</h2>
									<form method='POST' action='/update.php'>
										<input type='hidden' name='t' value='delete'>
										<input class='dialoguebutton button red' style='float:left' type='submit' value='Confirm'>
										<input class='dialoguebutton button' style='float:right' type='button' value='Cancel' data-hide='#delete-account-popup'>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<?php GlobalUtils::getFooter(); ?>

		</div>

		<?php GlobalUtils::getJS('settings/settings'); ?>
	</body>
</html>
