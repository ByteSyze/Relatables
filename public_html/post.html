<?php

	function setPost($p)
	{
		$post = $p;
		
		$author = $post->author;
		
		$format_date_diff = $post->calculateDateDifference();
		$format_user = $post->anonymous ? 'Anonymous' : $author->getUsername();
	}
	
?>
<div class='col-md-12'>
	<div class='panel panel-default'>
		<div class='panel-body'>
			<?php $post->submission; ?>
		</div>
		<div class="post-actions" data-v="<?php $post->verification ?>">
			<div class="panel-footer clearfix">
				<?php
				$button_yes_classes = "green-hover";
				$button_no_classes = "red-hover";

				if(isset($_SESSION['id'])) 
				{
						$button_yes_meta = $button_no_meta =  "data-vid=" . $post->id;
						
						if($post->user_vote === 0)
							$button_yes_classes = "green";
						else if($post->user_vote === 1)
							$button_no_classes = "red";
							
				} else 
				{
					$button_yes_meta = $button_no_meta = "data-signup-header=Please sign up to vote";
				}
				?>
				<a class="button small <?php $button_yes_classes ?>"<?php $button_yes_meta ?>  data-vc="<?php $post->notalone ?>">You're not alone <span class="badge"> <?php number_format($post->notalone) ?> </span></a>
				<a class="button small <?php $button_no_classes ?>"<?php $button_no_meta ?> data-vc="<?php $post->alone ?>">You're alone <span class="badge"> <?php number_format($post->alone) ?> </span></a>
				<a href="/post/<?php $post->id ?>" class="button comment small"><!--<div class="comment tail"></div>-->Comments <span class="badge"> <?php $post->comment_count ?> </span></a>
				<?php GlobalUtils::getShareButton(/**Dont remove this absolute path*/"http://www.relatables.com/post/" . $post->id, ".$post->submission.") ?>
				<span class='pull-right'>
					<?php
					if($post->anonymous)
					{
						echo "<span>$format_user</span>";
					} else 
					{
						echo '<a class="user'; 

						if($author->isAdmin())
							echo ' admin';

						echo  ' href="/user/' . $format_user . '">' . $format_user . '</a>';
					}
					?>
					<span class="datediff"><?php $format_date_diff ?></span>
				</span>
			</div>
		</div>
	</div>
</div>